{"version":3,"file":"js/4692.1675104915535.b78f274a06189644f7bb.js","mappings":"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","sources":["webpack:///./src/Utils/plugins.ts","webpack:///./src/sdk/createStore.ts"],"sourcesContent":["export type PluginType = {\n  name: string;\n  pathPrefix?: string;\n};\n\ntype GetActivePlugins = (isBeta: boolean, appName: string) => Promise<PluginType[]>;\n\nexport const getActivePlugins: GetActivePlugins = async (isBeta, appName) => {\n  try {\n    const response = await fetch(`${isBeta ? '/beta' : ''}/apps/${appName}/plugins.json`);\n    const isJson = response.headers.get('content-type')?.includes('application/json');\n    if (!isJson) {\n      throw new Error('plugin data response is not type application/json');\n    }\n    return await response.json();\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error('Failed to fetch plugin data', e);\n    return [];\n  }\n};\n","import { getActivePlugins } from '../Utils/plugins';\nimport packageInfo from '../../package.json';\nimport { PluginLoader, PluginLoaderOptions, PluginStore } from '@openshift/dynamic-plugin-sdk';\nimport type { To, NavigateOptions } from 'react-router-dom';\n\nconst calculateTo = (to: To) => {\n  if (typeof to === 'string' && !to.startsWith('/hac') && to.startsWith('/')) {\n    return `/hac${to}`;\n  } else if (typeof to !== 'string' && to.pathname && !to.pathname.startsWith('/hac')) {\n    return {\n      ...to,\n      pathname: `/hac${to.pathname}`,\n    };\n  }\n\n  return to;\n};\n\nconst modules: { [name: string]: () => Promise<() => any> } = {\n  '@openshift/dynamic-plugin-sdk-utils': async () => () => require('@openshift/dynamic-plugin-sdk-utils'),\n  '@openshift/dynamic-plugin-sdk': async () => () => require('@openshift/dynamic-plugin-sdk'),\n  '@patternfly/react-core': async () => () => require('@patternfly/react-core'),\n  '@patternfly/react-table': async () => () => require('@patternfly/react-table'),\n  react: async () => () => require('react'),\n  redux: async () => () => require('redux'),\n  'react-helmet': async () => () => require('react-helmet'),\n  'react-i18next': async () => () => require('react-i18next'),\n  '@scalprum/react-core': async () => () => require('@scalprum/react-core'),\n  'react-redux': async () => () => require('react-redux'),\n  'react-router': async () => () => require('react-router'),\n  '@patternfly/quickstarts': async () => () => require('@patternfly/quickstarts'),\n  '@unleash/proxy-client-react': async () => () => require('@unleash/proxy-client-react'),\n  'react-router-dom': async () => () => {\n    // We have to hack our way around react-router-dom\n    // Since we are no longer using basename we have to include `/hac` prefix\n    const reactRouter = require('react-router-dom');\n    return {\n      ...reactRouter,\n      useNavigate: () => {\n        const oldNavigate = reactRouter.useNavigate();\n        return (to: To, options?: NavigateOptions) => {\n          oldNavigate(calculateTo(to), options);\n        };\n      },\n      Link: (props: any) => {\n        const react = require('react');\n        const Cmp = reactRouter.Link;\n        return react.createElement(Cmp, { ...props, to: calculateTo(props.to) });\n      },\n      Navigate: (props: any) => {\n        const react = require('react');\n        const Cmp = reactRouter.Navigate;\n        return react.createElement(Cmp, { ...props, to: calculateTo(props.to) });\n      },\n      NavLink: (props: any) => {\n        const react = require('react');\n        const Cmp = reactRouter.NavLink;\n        return react.createElement(Cmp, { ...props, to: calculateTo(props.to) });\n      },\n    };\n  },\n};\n\nconst sharedScope = Object.keys(modules).reduce(\n  (acc, moduleRequest) => ({\n    ...acc,\n    [moduleRequest]: {\n      // The '*' semver range means \"this shared module matches all requested versions\",\n      // i.e. make sure the plugin always uses the Console-provided shared module version\n      '*': {\n        get: modules[moduleRequest],\n        // Indicates that Console has already loaded the shared module\n        loaded: true,\n      },\n    },\n  }),\n  {},\n);\n\nexport const createStore = () => {\n  const fetchImpl: PluginLoaderOptions['fetchImpl'] = (url, requestInit) => {\n    return fetch(url, requestInit);\n  };\n\n  // TODO: Remove postProcessManifest once all plugins have defaults for loadScripts and registrationMethod\n  const pluginLoader = new PluginLoader({\n    fetchImpl,\n    sharedScope,\n    postProcessManifest: (manifest) => ({\n      ...manifest,\n      loadScripts: manifest.loadScripts ?? ['plugin-entry.js'],\n      registrationMethod: manifest.registrationMethod ?? 'callback',\n    }),\n  });\n  pluginLoader.registerPluginEntryCallback();\n  const pluginStore = new PluginStore();\n  pluginStore.setLoader(pluginLoader);\n  getActivePlugins(window.insights.chrome.isBeta(), packageInfo.insights.appname).then((data) => {\n    data.forEach(({ name: item, pathPrefix = '/api/plugins' }) => {\n      const url = `/beta${pathPrefix}/${item}/`;\n      pluginStore.loadPlugin(url);\n    });\n  });\n  return pluginStore;\n};\nexport const pluginStore = createStore();\n"],"names":["getActivePlugins","isBeta","appName","response","fetch","headers","get","includes","Error","json","e","console","error","calculateTo","to","startsWith","pathname","modules","react","redux","reactRouter","useNavigate","oldNavigate","options","Link","props","Cmp","createElement","Navigate","NavLink","sharedScope","Object","keys","reduce","acc","moduleRequest","loaded","createStore","pluginLoader","PluginLoader","fetchImpl","url","requestInit","postProcessManifest","manifest","loadScripts","registrationMethod","registerPluginEntryCallback","pluginStore","PluginStore","setLoader","window","insights","chrome","then","data","forEach","name","item","pathPrefix","loadPlugin"],"sourceRoot":""}