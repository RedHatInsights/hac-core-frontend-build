(self.webpackChunkhac_core=self.webpackChunkhac_core||[]).push([[129],{68876:e=>{e.exports={}},93738:(e,t,n)=>{"use strict";n.d(t,{Z:()=>R});var a=n(93264),r=n(55399),o=n(97066),l=n(96733);const s=()=>a.createElement(o.EmptyState,null,a.createElement(o.EmptyStateIcon,{icon:l.ZP}),a.createElement(o.Title,{headingLevel:"h4",size:"lg"},"Empty Route"),a.createElement(o.EmptyStateBody,null,a.createElement("p",null,"Nothing to see here.")));var c=n(59730),i=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};const u=({object:e})=>{const[t,n]=a.useState(!1),r=e=>{if(Array.isArray(e))return e.map(r);const{apiVersion:t,kind:n,apiGroup:a}=e,o=e.metadata,{managedFields:l}=o,s=i(o,["managedFields"]),c=i(e,["apiVersion","kind","apiGroup","metadata"]);return Object.assign({apiVersion:t,kind:n,apiGroup:a,metadata:s},c)};return e?a.createElement("pre",{style:{overflow:"hidden",maxHeight:t?void 0:150,position:"relative",paddingTop:25}},JSON.stringify(r(e),null,2),t?a.createElement("div",{onClick:()=>n(!1),style:{cursor:"pointer",top:0,width:"100%",position:"absolute",textAlign:"center"}},"(Click to collapse)"):a.createElement("div",{onClick:()=>n(!0),style:{cursor:"pointer",background:"linear-gradient(transparent, gray)",bottom:0,width:"100%",height:"100%",position:"absolute",textAlign:"center"}},"(Click to expand)")):a.createElement("div",null,"No Object to Report")},p=({socketBeingCreated:e,socketOpen:t,resourceLoaded:n})=>e?t?n?null:a.createElement("p",null,"Socket Open."):a.createElement(o.Spinner,null):null,d={apiVersion:"v1",apiGroup:"project.openshift.io",kind:"Project",plural:"projects"},m={apiVersion:"v1alpha1",kind:"Application",apiGroup:"appstudio.redhat.com",plural:"applications"},h=({namespace:e})=>{const[t,n]=a.useState(null),[r,l]=a.useState(null),[s,i]=a.useState(!1),[d,h]=a.useState();return a.useEffect((()=>{let e;if(d){let t=d;/^\/\//.test(d)&&(t=d.slice(1)),e=new c.WebSocketFactory("sample websocket",{path:t}),e.onOpen((()=>{i(!0)})),e.onError((e=>{console.debug("error",e)})),e.onMessage((e=>{try{let t;t="string"==typeof e?JSON.parse(e):e;const{type:a,object:r}=t||{};n("DELETED"===a?null:r),console.debug("message",a,r)}catch(e){return console.error(">>> Web Socket Data Bad",e),void l("Web Socket data unknown structure")}})),e.onClose((e=>{i(!1),n(null),h(void 0),console.debug("close",e,"code:",e.code)}))}return()=>{null==e||e.destroy(),e=null}}),[d]),a.createElement(a.Fragment,null,a.createElement(o.Title,{headingLevel:"h2",size:"xl"},"Websockets"),a.createElement("p",null,"Needs a created Application to successfully return details."),!d&&(e?a.createElement(a.Fragment,null,a.createElement("p",null,"Create Web Socket Connection to:"),a.createElement(o.Button,{onClick:()=>{h((0,c.getK8sResourceURL)(m,void 0,{ns:e}))},variant:"primary"},"Applications")):a.createElement("p",null,"Need a namespace")),a.createElement(p,{socketBeingCreated:!!d,socketOpen:s,resourceLoaded:!!t}),s&&!t&&a.createElement("p",null,"No response -- did you create the Application?"),r&&a.createElement(o.Alert,{variant:"danger",title:"Websocket Error"},r),t&&a.createElement(u,{object:t}))};var E;!function(e){e.CREATE="create",e.GET="get",e.PATCH="patch",e.PUT="put",e.DELETE="delete"}(E||(E={}));const g=({namespace:e})=>{const[t,n]=a.useState(null),[r,l]=a.useState("test"),[s,i]=a.useState(""),[p,d]=a.useState(null),[h,g]=a.useState(null);return a.useEffect((()=>{const t={name:r,ns:e},a={apiVersion:`${m.apiGroup}/${m.apiVersion}`,kind:m.kind,metadata:{name:r,namespace:e}};let o=null;switch(p){case E.CREATE:o=(0,c.k8sCreateResource)({model:m,queryOptions:t,resource:a});break;case E.GET:o=(0,c.k8sGetResource)({model:m,queryOptions:t}).then((e=>{var t;return g(null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.resourceVersion),e}));break;case E.PATCH:o=(0,c.k8sPatchResource)({model:m,queryOptions:t,patches:[{op:"replace",path:"/test",value:"false"}]});break;case E.PUT:o=(0,c.k8sUpdateResource)({model:m,queryOptions:t,resource:Object.assign(Object.assign({},a),{metadata:Object.assign(Object.assign({},a.metadata),{resourceVersion:h})})}).then((e=>{var t;return g(null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.resourceVersion),e}));break;case E.DELETE:o=(0,c.k8sDeleteResource)({model:m,queryOptions:t});break;case null:break;default:throw new Error("uh oh!")}null==o||o.then((e=>{i(`${p} response:`),n(e),console.debug(`++++${p}!`,e)})).catch((e=>{console.error(`++++failed ${p}`,e),i(`failed call: ${e.message}`),n(null)})).finally((()=>{d(null)}))}),[p,r,e,h]),a.createElement(a.Fragment,null,a.createElement(o.Title,{headingLevel:"h2",size:"xl"},"Fetch Calls"),a.createElement(o.TextInput,{placeholder:"Application name",onChange:e=>l(e),value:r}),a.createElement("div",null,a.createElement("p",null,"Test calls -- predefined data; use the above input to make/update/get multiple Applications"),Object.values(E).map((e=>a.createElement(a.Fragment,{key:e},a.createElement(o.Button,{isDisabled:e===E.PUT&&null===h,onClick:()=>d(e)},e)," ")))),a.createElement("div",null,s),t&&a.createElement(u,{object:t}))},f=({namespace:e,setNamespace:t})=>{const[n,r]=a.useState(null),l=(0,c.isUtilsConfigSet)();return a.useEffect((()=>{l&&(0,c.k8sListResourceItems)({model:d}).then((e=>{var n;const a=null===(n=e[0])||void 0===n?void 0:n.metadata.name;a?t(a):r('Could not find namespace; you are likely not able to do much as we are targeting "default"')})).catch((e=>{r(`Unknown issue loading namespace ${null==e?void 0:e.message}`)}))}),[l,t]),n?a.createElement(o.Alert,{variant:"danger",isInline:!0,title:"Determining Namespace Error"},n):e?a.createElement("p",null,"Current namespace: ",e):a.createElement(a.Fragment,null,a.createElement(o.Spinner,null)," Loading Namespace")},v=({namespace:e})=>{const[t,n]=a.useState("test"),r={isList:!1,groupVersionKind:{group:"appstudio.redhat.com",version:"v1alpha1",kind:"Application"},name:t,namespace:e},l={application:{isList:!1,groupVersionKind:{group:"appstudio.redhat.com",version:"v1alpha1",kind:"Application"},name:t,namespace:e}},[s,i,u]=(0,c.useK8sWatchResource)(r),p=i||!!u;p&&console.log("data from useK8sWatchResource: ",s);const{application:d}=(0,c.useK8sWatchResources)(l),m=d.loaded||!!d.loadError,{data:h}=d;return m&&console.log("data from useK8sWatchResources: ",h),a.createElement(a.Fragment,null,a.createElement(o.Title,{headingLevel:"h2",size:"xl"},"Test hooks to watch Application"),a.createElement(o.TextInput,{placeholder:"Application name",onChange:e=>n(e),value:t}),a.createElement(o.TextContent,null,a.createElement(o.Text,{component:o.TextVariants.h4},"useK8sWatchResource (watch Application: ",t,")"),!p&&a.createElement(o.Text,{component:o.TextVariants.p},"Loading resource..."),p&&s&&a.createElement(o.Text,{component:o.TextVariants.p},"Resource loaded"),p&&!s&&a.createElement(o.Text,{component:o.TextVariants.p},"No data -- did you create the Application?")),a.createElement("br",null),a.createElement(o.TextContent,null,a.createElement(o.Text,{component:o.TextVariants.h4},"useK8sWatchResources (watch Application: ",t,")"),!m&&a.createElement(o.Text,{component:o.TextVariants.p},"Loading resource..."),m&&h&&a.createElement(o.Text,{component:o.TextVariants.p},"Resource loaded"),m&&!h&&a.createElement(o.Text,{component:o.TextVariants.p},"No data -- did you create the Application?")))},y=()=>{const[e,t]=a.useState();return a.createElement(o.PageSection,null,a.createElement(f,{namespace:e,setNamespace:t}),e&&a.createElement(a.Fragment,null,a.createElement("hr",{style:{margin:20}}),a.createElement(g,{namespace:e}),a.createElement("hr",{style:{margin:20}}),a.createElement(v,{namespace:e}),a.createElement("hr",{style:{margin:20}}),a.createElement(h,{namespace:e})))},b=a.lazy((()=>Promise.all([n.e(382),n.e(550),n.e(555),n.e(107)]).then(n.bind(n,95313)))),k=()=>a.createElement(a.Suspense,{fallback:a.createElement(o.Bullseye,null,a.createElement(o.Spinner,null))},a.createElement(r.Switch,null,a.createElement(r.Route,{exact:!0,path:"/testK8s",component:y}),a.createElement(r.Route,{path:"/:dynamicPath",component:b}),a.createElement(r.Route,{exact:!0,path:"/",component:s}),a.createElement(r.Route,null,a.createElement(r.Redirect,{to:"/"}))));var T=n(8738),w=n(94),S=n(83215),x=n(55140),O=n(6565);const R=()=>{const e=(0,r.useHistory)(),t=(0,x.Z)(),n=(0,O.useStore)();return a.useEffect((()=>{(0,T.JH)().register({notifications:S.ee});const{on:n}=null==t?void 0:t.init(),a=n("APP_NAVIGATION",(t=>{t.domEvent&&e.push(`${t.domEvent.href.replace("/hac","")}`)}));return()=>{a()}}),[e,t]),a.createElement(a.Fragment,null,a.createElement(w.ZP,{store:n}),a.createElement(k,null))}},72634:(e,t,n)=>{"use strict";n.d(t,{W:()=>g});var a=n(93264),r=n(59730),o=n(97066);const l=()=>a.createElement(o.Bullseye,null,a.createElement(o.Spinner,null));class s extends Error{constructor(e){super(e),Object.defineProperty(this,"name",{value:new.target.name,enumerable:!1,configurable:!0}),"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error(e).stack,Object.setPrototypeOf(this,new.target.prototype)}}class c extends s{constructor(e,t,n,a){super(e),this.code=t,this.response=n,this.json=a}static fromCode(e){return new c(c.messages[e],e)}}c.messages={400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",510:"Not Extended",511:"Network Authentication Required"};var i=function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function l(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,s)}c((a=a.apply(e,t||[])).next())}))};const u="/api/k8s",p=e=>(t,n)=>i(void 0,void 0,void 0,(function*(){var{pathPrefix:a}=n,r=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}(n,["pathPrefix"]);const o=yield e.getToken();if(!o)return Promise.reject("Could not make k8s call. Unable to find token.");const l=Object.assign(Object.assign({},r),{headers:Object.assign(Object.assign({},r.headers),{Accept:"application/json",Authorization:`Bearer ${o}`})}),s=`${0===(null!=a?a:u).indexOf("/")?"":"/"}${null!=a?a:u}`;try{let e=t;return/^\/\//.test(t)&&(e=t.slice(1)),p=yield fetch(new Request(`${s}${e}`,{credentials:"include"}),l),i(void 0,void 0,void 0,(function*(){if(p.ok)return p;if(401===p.status)throw new c("Invalid token. Are you working with Prod SSO token?",p.status,p);const e=p.headers.get("content-type");if(!e||-1===e.indexOf("json"))throw new c(p.statusText,p.status,p);return 403===p.status?p.json().then((e=>{throw new c(e.message||"Access denied due to cluster policy.",p.status,p,e)})):p.json().then((e=>{var t,n;const a=null===(n=null===(t=e.details)||void 0===t?void 0:t.causes)||void 0===n?void 0:n[0];let r;throw a&&(r=`Error "${a.message}" for field "${a.field}".`),r||(r=e.message),r||(r=e.error),r||(r=p.statusText),new c(r,p.status,p,e)}))}))}catch(e){return Promise.reject(e)}var p})),d=e=>[`base64url.bearer.authorization.k8s.io.${btoa(e).replace(/\+/g,"-").replace(/\//g,"_").split("=",1)[0]}`,"base64.binary.k8s.io"];var m=n(71626),h=n(55140);const E=()=>{const{auth:e}=(0,h.Z)(),[t,n]=a.useState(null);return a.useEffect((()=>{e&&!t&&n({appFetch:p(e),wsAppSettings:()=>{return t=void 0,n=void 0,r=function*(){const t=yield e.getToken();return{host:`wss://${location.host}/wss/k8s`,subProtocols:d(t),urlAugment:e=>{const[t,n]=e.split("?")||[],a=new URLSearchParams(n);return a.get("watch")||a.set("watch","true"),`${t}?${a.toString()}`}}},new((a=void 0)||(a=Promise))((function(e,o){function l(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(l,s)}c((r=r.apply(t,n||[])).next())}));var t,n,a,r},apiPriorityList:["appstudio.redhat.com"],pluginStore:m.pluginStore})}),[t,m.pluginStore,e]),t},g=({children:e})=>{const t=E();return t?a.createElement(r.AppInitSDK,{configurations:t},e):a.createElement(l,null)}},28527:(e,t,n)=>{"use strict";n.d(t,{S1:()=>u});var a=n(8738),r=n(68573),o=n.n(r),l=n(84885),s=n(59730),c=n(53894);let i;function u(...e){return i=(0,a.JH)({},[c.Z,o(),(0,l.uv)({errorDescriptionKey:["detail","stack"]}),...e.filter(Boolean)]),i.register(s.SDKReducers),i}},45467:()=>{},81754:()=>{},34946:()=>{},80598:()=>{},10108:()=>{},30187:()=>{},93398:()=>{},46928:()=>{},66822:()=>{},49854:()=>{},74181:()=>{},11177:()=>{}}]);
//# sourceMappingURL=../sourcemaps/129.5eb4f3a71843fce0c79677840ac2f3e3.js.map